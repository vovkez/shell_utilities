#!/bin/bash

# Define variables
CREDENTIALS_FILE="logins.txt"
MAX_INSTANCES=10  # Adjust this number as needed

# Check if 'psst' is installed and accessible
if ! command -v psst &> /dev/null
then
    echo "psst is not installed. Exiting."
    exit 1
fi

# Check if credentials file exists
if [ ! -f "$CREDENTIALS_FILE" ]; then
    echo "Credentials file not found: $CREDENTIALS_FILE"
    exit 1
fi

# Read credentials and launch instances
index=0
while IFS= read -r line && [ "$index" -lt "$MAX_INSTANCES" ]
do
    # Decode the credentials from Base64
    decoded_line=$(echo "$line" | base64 --decode)
    username=$(echo "$decoded_line" | cut -d':' -f1)
    password=$(echo "$decoded_line" | cut -d':' -f2)

    # Launch psst instance
    # Placeholder for the psst command, adjust as necessary
    echo "Launching psst for user $username"
    psst --username "$username" --password "$password" &
    index=$((index+1))
done < "$CREDENTIALS_FILE"

echo "Deployment complete. Launched $index instances of psst."
